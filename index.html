<script src="db_clean_128.js"></script> <script>
    function login() {
        const mail = document.getElementById('email').value.toLowerCase().trim();
        const pass = document.getElementById('pwd').value.toUpperCase().trim();
        
        // "db" est maintenant rempli automatiquement par le fichier db_clean_128.js
        const user = db.find(u => u.e === mail && u.p === pass);

        if(user) {
            document.getElementById('login-view').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('u-name').innerText = user.n;
            document.getElementById('u-email').innerText = user.e;
            document.getElementById('p-text').innerText = user.t + '%';
            document.getElementById('m-count').innerText = user.m.length;

            const list = document.getElementById('missing-list');
            if(user.m.length > 0) {
                list.innerHTML = user.m.map(item => `<div class="missing-item">${item}</div>`).join('');
                document.getElementById('missing-box').style.display = 'block';
            } else {
                document.getElementById('missing-box').style.display = 'none';
                list.innerHTML = "<p style='color:green'>Toutes les activités sont terminées !</p>";
            }
        } else {
            document.getElementById('err').style.display = 'block';
        }
    }
</script>
</body>
</html>
